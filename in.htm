<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>小書籤</title>
  <link rel="shortcut icon" href="favicon.ico">
  <link type="text/css" rel="stylesheet" href="stylesheets/styles.css">
  <link type="text/css" rel="stylesheet" href="stylesheets/pygment_trac.css">
  <script type="text/javascript" src="javascripts/scale.fix.js"></script>
</head>

<body>
  <div id="Top">
    <h1>練習本</h1>
  </div>
  <div class="wrapper">
    <div class="content">
      <div class="box"></div>
      <section>
        <h3>
          <a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span
              class="octicon octicon-link"></span></a>Welcome to GitHub Pages.
        </h3>
        <p>.net访问数据库的三个基本步骤：</p>
        <p>一.连接数据库：</p>
        <p>二.编辑操作命令：</p>
        <p>三.读取数据（数据读取有两种操作方式：DataSet和DataReader）</p>
        <pre>
        <code><span class="highlight">
Public Class Form1
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim myconnect As New SqlClient.SqlConnection
        Dim mycommand As New SqlClient.SqlCommand
        Dim myread As SqlClient.SqlDataReader = Nothing  'DataReader
        Dim mytable As New DataTable()
        Dim mystr(3) As String
        myconnect.ConnectionString = "server=192.168.0.100;database=temp;integrated security=true;uid=sa;pwd=123456"'连接属性
        myconnect.Open()        '打开数据库
        mycommand.Connection = myconnect        '设置命令属性
        mycommand.CommandType = CommandType.Text
        mycommand.CommandText = "select * from stu"
        Dim sno As DataColumn = New DataColumn("sno")             '添加列
        Dim sname As DataColumn = New DataColumn("sname")
        Dim ssex As DataColumn = New DataColumn("ssex")
        Dim sphone As DataColumn = New DataColumn("sphone")
        mytable.Columns.Add(sno)              '将列添加到表格中
        mytable.Columns.Add(sname)
        mytable.Columns.Add(ssex)
        mytable.Columns.Add(sphone)
        myread = mycommand.ExecuteReader      '执行读取动作
        While (myread.Read)                   '不为空则一直读
            myread.GetValues(mystr)           '执行读取动作,将一行数据存入mystr数组中
            mytable.Rows.Add(mystr)           '将数组数据作为一行添加到表中
        End While
        DataGridView1.DataMember = "mytable"  '将表格与现实控件绑定
        DataGridView1.DataSource = mytable
        myread.Close()      '关闭读
        myconnect.Close()   '关闭连接
    End Sub
    
    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Dim myconnect As New SqlClient.SqlConnection
        Dim mycommand As New SqlClient.SqlCommand
        Dim myadp As New SqlClient.SqlDataAdapter    
        Dim mydataset As New DataSet             'DataSet
        myconnect.ConnectionString = "server=172.0.01;database=temp;integrated security=true;uid=sa;pwd=123456"
        myconnect.Open()
        mycommand.Connection = myconnect
        mycommand.CommandType = CommandType.Text
        mycommand.CommandText = "select * from stu"
        myadp.SelectCommand = mycommand
        myadp.Fill(mydataset)
        DataGridView1.DataSource = mydataset.Tables(0)
        myconnect.Close()
    End Sub
End Class</span></code>
         </pre>
        <p>If you're using the GitHub for Mac, simply sync your repository and you'll see the new branch.</p>
        <h3>
          <a id="designer-templates" class="anchor" href="#designer-templates" aria-hidden="true"><span
              class="octicon octicon-link"></span></a>Designer Templates
        </h3>
        <p>You can <a href="https://github.com" class="user-mention">@mention</a> a GitHub username to generate
          a link to their profile. The resulting <code>&lt;a&gt;</code> element will link to the contributor's GitHub
          Profile. For example: In 2007, Chris Wanstrath , and Tom Preston-Werner (<a href="https://github.com"
            class="user-mention">@lianxiben</a>) founded GitHub.
        </p>
        <h3>
          <a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span
              class="octicon octicon-link"></span></a>Support or Contact
        </h3>
        <p>Having trouble with Pages? Check out the documentation at <a
            href="https://help.github.com/pages">https://help.github.com/pages</a> or contact <a
            href="mailto:support@github.com">support@github.com</a> and we’ll help you sort it out.
        </p>
      </section>
    </div>
  </div>
  <!--[if !IE]><script>fixScale(document);</script><![endif]-->

</body>

</html>
